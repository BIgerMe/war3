<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>玲の百草园</title>
    <link rel="icon" href="http://head.xxroom.xyz/FnUQ7IFfcrP6i0XVHtDdJ5vLwhdV" type="image/x-icon">
    <link rel="shortcut icon" href="http://head.xxroom.xyz/FnUQ7IFfcrP6i0XVHtDdJ5vLwhdV" type="image/x-icon">
    <script type="text/javascript" src="../assets/js/Common.js"></script>
    <link rel="stylesheet" href="/assets/css/nav/style.css">
    <link rel="stylesheet" href="/assets/css/nav/iconStyle.css">

</head>
<style type="text/css">
    .nav-list{
        text-align: center;
        margin:10px 0;
    }
    .nav-list>a{
        color: skyblue;!important;
        font-weight: 600;
    }
</style>
<body>
<header class="mobile-header-wrap">
    <a class="mobile-logo" href="#">
        <img src="/assets/images/xxroom-dark.png">
    </a>
</header>
<div class="btn-mobile-sidenav">
    <div class="nav-bar" onclick="navFold()">
        <span></span>
        <span></span>
        <span></span>
    </div>
</div>
<div id="list-example" class="list-group col-lg-2">
    <div class="sidenav">
        <a class="logo" href="/view/index.html">
            <img src="/assets/images/xxroom-dark.png" alt="logo">
        </a>
        <div class="site-description">
            返回主页
        </div>

        <div class="nav-list">
            <a href="#社区">
                <svg class="bi bi-house-door" width="15" height="15" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M7.646 1.146a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5H9.5a.5.5 0 0 1-.5-.5v-4H7v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6zM2.5 7.707V14H6v-4a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4h3.5V7.707L8 2.207l-5.5 5.5z"/>
                    <path fill-rule="evenodd" d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
                </svg>
                社区
            </a>
        </div>
        <div class="nav-list">
            <a href="#前端">
                <svg class="bi bi-app" width="15" height="15" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M11 2H5a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V5a3 3 0 0 0-3-3zM5 1a4 4 0 0 0-4 4v6a4 4 0 0 0 4 4h6a4 4 0 0 0 4-4V5a4 4 0 0 0-4-4H5z"/>
                </svg>
                前端
            </a>
        </div>
        <div class="nav-list">
            <a href="#后端">
                <svg class="bi bi-hexagon" width="15px" height="15px" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M14 4.577L8 1 2 4.577v6.846L8 15l6-3.577V4.577zM8.5.134a1 1 0 0 0-1 0l-6 3.577a1 1 0 0 0-.5.866v6.846a1 1 0 0 0 .5.866l6 3.577a1 1 0 0 0 1 0l6-3.577a1 1 0 0 0 .5-.866V4.577a1 1 0 0 0-.5-.866L8.5.134z"/>
                </svg>
                后端
            </a>
        </div>
        <div class="nav-list">
            <a href="#产品">
                <svg class="bi bi-octagon" width="15px" height="15px" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353L4.54.146zM5.1 1L1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1H5.1z"/>
                </svg>
                产品
            </a>
        </div>
        <div class="nav-list">
            <a href="#运营">
                <svg class="bi bi-pentagon" width="15px" height="15px" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M8 1.288l-6.842 5.56L3.733 15h8.534l2.575-8.153L8 1.288zM16 6.5L8 0 0 6.5 3 16h10l3-9.5z"/>
                </svg>
                运营
            </a>
        </div>
        <div class="nav-list">
            <a href="#视频">
                <svg class="bi bi-camera-video-fill" width="15px" height="15px" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2.667 3h6.666C10.253 3 11 3.746 11 4.667v6.666c0 .92-.746 1.667-1.667 1.667H2.667C1.747 13 1 12.254 1 11.333V4.667C1 3.747 1.746 3 2.667 3z"/>
                    <path d="M7.404 8.697l6.363 3.692c.54.313 1.233-.066 1.233-.697V4.308c0-.63-.693-1.01-1.233-.696L7.404 7.304a.802.802 0 0 0 0 1.393z"/>
                </svg>
                视频
            </a>
        </div>
        <div class="nav-list">
            <a href="#游戏">
                <svg class="bi bi-controller" width="15px" height="15px" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M11.119 2.693c.904.19 1.75.495 2.235.98.407.408.779 1.05 1.094 1.772.32.733.599 1.591.805 2.466.206.875.34 1.78.364 2.606.024.815-.059 1.602-.328 2.21a1.42 1.42 0 0 1-1.445.83c-.636-.067-1.115-.394-1.513-.773a11.307 11.307 0 0 1-.739-.809c-.126-.147-.25-.291-.368-.422-.728-.804-1.597-1.527-3.224-1.527-1.627 0-2.496.723-3.224 1.527-.119.131-.242.275-.368.422-.243.283-.494.576-.739.81-.398.378-.877.705-1.513.772a1.42 1.42 0 0 1-1.445-.83c-.27-.608-.352-1.395-.329-2.21.024-.826.16-1.73.365-2.606.206-.875.486-1.733.805-2.466.315-.722.687-1.364 1.094-1.772.486-.485 1.331-.79 2.235-.98.932-.196 2.03-.292 3.119-.292 1.089 0 2.187.096 3.119.292zm-6.032.979c-.877.185-1.469.443-1.733.708-.276.276-.587.783-.885 1.465a13.748 13.748 0 0 0-.748 2.295 12.351 12.351 0 0 0-.339 2.406c-.022.755.062 1.368.243 1.776a.42.42 0 0 0 .426.24c.327-.034.61-.199.929-.502.212-.202.4-.423.615-.674.133-.156.276-.323.44-.505C4.861 9.97 5.978 9.026 8 9.026s3.139.943 3.965 1.855c.164.182.307.35.44.505.214.25.403.472.615.674.318.303.601.468.929.503a.42.42 0 0 0 .426-.241c.18-.408.265-1.02.243-1.776a12.354 12.354 0 0 0-.339-2.406 13.753 13.753 0 0 0-.748-2.295c-.298-.682-.61-1.19-.885-1.465-.264-.265-.856-.523-1.733-.708-.85-.179-1.877-.27-2.913-.27-1.036 0-2.063.091-2.913.27z"/>
                    <path d="M11.5 6.026a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm-1 1a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm2 0a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm-1 1a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm-7-2.5h1v3h-1v-3z"/>
                    <path d="M3.5 6.526h3v1h-3v-1zM3.051 3.26a.5.5 0 0 1 .354-.613l1.932-.518a.5.5 0 0 1 .258.966l-1.932.518a.5.5 0 0 1-.612-.354zm9.976 0a.5.5 0 0 0-.353-.613l-1.932-.518a.5.5 0 1 0-.259.966l1.932.518a.5.5 0 0 0 .612-.354z"/>
                </svg>
                游戏
            </a>
        </div>
        <div class="nav-list">
            <a href="#爱好">
                <svg class="bi bi-circle" width="15px" height="15px" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                </svg>
                爱好
            </a>
        </div>
        <div class="nav-list">
            <a href="#常用">
                <svg class="bi bi-star" width="15px" height="15px" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.523-3.356c.329-.314.158-.888-.283-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767l-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288l1.847-3.658 1.846 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.564.564 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z"/>
                </svg>
                常用
            </a>
        </div>
        <div class="nav-list">
            <a href="#第三方">
                第三方
            </a>
        </div>
        <div class="nav-list">
            <a href="#财经">
                财经
            </a>
        </div>
    </div>

</div>
<div class="main-wrap">
    <div class="main">
        <div class="board selected-nav">
            <div class="nav-left">
                <span class="selected-nav-cn">设计</span>
                <span class="selected-nav-en">Design</span>
            </div>
        </div>
    </div>
</div>
<!--新增导航-->
</body>
</html>

<script>

    $(function(){
        navLists();
    });

    /*搜索导航*/
    function searchNav(){
        let key = $("#navKey").val();
        navLists(key);
    }
    /*导航栏折叠*/
    function navFold(){
        $(".nav-bar").toggleClass("nav-bar-animate");
        $(".sidenav").toggleClass('show-sidenav');
    }
    //分类展示导航列表
    function navLists(key=''){
        $.ajax({
            type: "get",
            dataType: "json",
            data: {key:key},
            url: "/web/nav/listsByCate",
            async: true,
            beforeSend: function(request) {
                request.setRequestHeader("Token", getToken());
            },
            success: function (result) {
                if(result.error == 0){
                    let html = "";
                    $.each(result.data,function(k,v){
                        let bodyHtml =  ''
                        $.each(v,function(ck,cv){
                            bodyHtml += "<div class='col-sm-6 col-md-4 col-lg-3'>\n" +
                                "                        <div class='card'>\n" +
                                "                            <a class='card-heading link-tooltip' onclick='view("+cv.id+")' title='"+cv.href+"' href='"+cv.href+"' target='_blank'>\n" +
                                "                                <span class='card-icon'>\n" +
                                "                                    <img src='"+cv.logo+"'>\n" +
                                "                                </span>\n" +
                                "                                <span class='card-title'>\n" +
                                "                                    "+cv.title+"\n" +
                                "                                </span>\n" +
                                "                            </a>\n" +
                                "                            <div class='card-body'>\n" +
                                "                                "+cv.content+"</div>\n" +
                                "                            <div class='card-footer'>\n" +
                                "                                    <img src='../assets/images/icons/eye.svg' alt='查看' width='15' height='15' title='查看'>\n" +
                                "                                    <span>\n" +
                    "                                                    "+cv.view+"\n" +
                                "                                </span>\n" +
                                "                            </div>\n" +
                                "                        </div>\n" +
                                "                    </div>"
                        })
                        html += "<a id='"+k+"'></a>\n" +
                            "        <div class='panel'>\n" +
                            "            <div class='panel-title card'>\n" +
                            "                "+k+"\n" +
                            "            </div>\n" +
                            "            <div class='panel-body'>\n" +
                            "                <div class='row'>\n" +
                                bodyHtml +
                            "                </div>\n" +
                            "            </div>\n" +
                            "        </div>"
                    })
                    $(".main").append(html);
                }else{}
            }
        });
    }
    //查看+1
    function view(id){
        $.ajax({
            type: "post",
            dataType: "json",
            url: "/web/nav/view",
            data: {id:id},
            async: true,
            success: function (result) {
                return;
            }
        });
    }
    function preview(e) {
        //为文件读取成功设置事件

        let file = $(e)[0].files[0];
        if(!/image\/\w+/.test(file.type)) //判断获取的是否为图片文件
        {
            alert("请确保文件为图像文件");
            return false;
        }
        //创建读取文件的对象
        let reader = new FileReader();
        reader.onload = function (e) {
            let imgFile = e.target.result;
            $("#logoPreview").attr('src',imgFile);
        };
        //创建文件读取相关的变量
        reader.readAsDataURL(file);
    }
    /*保存*/
    function navSave(){
        qn_upload()
        let img = $("#logoPreview").attr('src');
        let title =  $("#title").val();
        let href = $("#href").val();
        let category = $("#category").val();
        if(img == 'http://head.xxroom.xyz/photo_icon.png'){
            alert("请上传图片");
            return false;
        }else if(!title){
            alert("标题不能为空")
            return false;
        }if(!href){
            alert("链接不能为空")
            return false;
        }
        $.ajax({
            type: "post",
            dataType: "json",
            url: "/web/nav/navSave",
            data: {img:img,title:title,href:href,category:category},
            beforeSend: function(request) {
                request.setRequestHeader("Token", getToken());
            },
            async: false,
            success: function (result) {
                alert(result.msg)
            },
            error: function (result) {
                alert(result.msg);
                return false;
            }
        });
    }
    function qn_upload(){
        $.ajax({
            type: "get",
            dataType: "json",
            url: "/web/img/qiniuToken",
            data: {},
            beforeSend: function(request) {
                request.setRequestHeader("Token", getToken());
            },
            async: false,
            success: function (result) {
                token = result.data.token;
            }
        });
        if(!token){
            alert('token获取失败');return false;
        }

        var file = $("#logo")[0].files[0];
        if(!file){
            return false;
        }
        //多图片上传
        //网络协议
        var protocolStr = document.location.protocol;
        var url = (protocolStr == 'http:') ? 'http://up.qiniup.com' : 'https://up.qbox.me';

        let form = new FormData();
        form.append('file',file);
        form.append('token',token);
        $.ajax({
            url: url,
            type: 'POST',
            dataType:'json',
            contentType: false,
            processData: false,
            data: form,
            async: false,
            success: function (rst) {
                let img = "http://head.xxroom.xyz/" + rst.key;
                add_attachment(img,file.size);
                $("#logoPreview").attr('src',img);
                return
            },
            error: function () {
                alert('图标上传失败');
                return false;
            }
        });
    }

    //增加附件
    function add_attachment(path,size){
        let url = '/web/img/addAttachment';
        $.ajax({
            url: url,
            type: 'POST',
            dataType:'json',
            async:false,
            data: {path:path,size:size},
            beforeSend: function(request) {
                request.setRequestHeader("Token", getToken());
            },
            success: function (rst) {
                return
            },
            error: function () {
                return
            }
        });
    }

</script>